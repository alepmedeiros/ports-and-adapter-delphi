program porstandadapter;

{$APPTYPE CONSOLE}

{$R *.res}

uses
  Horse,
  Horse.Jhonson,
  System.JSON,
  Data.DB,
  System.SysUtils,
  DataSet.Serialize,
  connection in 'connection.pas' {DataModule1: TDataModule};

begin
  THorse.Post('/checking', procedure(Req: THorseRequest; Res: THorseResponse)
  begin
    connection.DataModule1.FDConnection1.Connected := true;
    Writeln(Req.Body);
    connection.DataModule1.FDQuery1.Open('select * from parked_car');
    Writeln(connection.DataModule1.FDQuery1.ToJSONObject.ToString);
  end);

  THorse.Listen(9000);
end.
